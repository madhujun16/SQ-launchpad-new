<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>SmartQ Launchpad</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#43A047" />
    <meta name="description" content="SmartQ Launchpad - Intelligent Site Management Platform" />
    
    <!-- Security and Performance Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
    
    <!-- Open Graph and Twitter Meta Tags -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="SmartQ Launchpad" />
    <meta property="og:description" content="Intelligent Site Management Platform" />
    <meta property="og:image" content="/smartq-launchpad-logo.svg" />
    <meta property="og:url" content="https://sqlaunchpad.com" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="SmartQ Launchpad" />
    <meta name="twitter:description" content="Intelligent Site Management Platform" />
    <meta name="twitter:image" content="/smartq-launchpad-logo.svg" />
    
    <link rel="apple-touch-icon" href="/smartq-launchpad-logo.svg" />
    
    <!-- Resource hints for better performance -->
    <link rel="dns-prefetch" href="https://ngzvoekvwgjinagdvdhf.supabase.co">
    <link rel="preconnect" href="https://ngzvoekvwgjinagdvdhf.supabase.co">
    
    <!-- Chrome-specific optimizations -->
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="/src/index.css" as="style">
    
    <!-- TEMPORARILY DISABLED: Preload links causing 404 errors -->
    <!-- <link rel="preload" href="/smartq-launchpad-logo.svg" as="image">
    <link rel="preload" href="/favicon.svg" as="image">
    <link rel="preload" href="/manifest.json" as="fetch">
    <link rel="modulepreload" href="/src/main.tsx"> -->
    
    <!-- CSS optimization -->
    <style>
      /* Critical CSS for mobile performance */
      body { margin: 0; padding: 0; }
      #root { min-height: 100vh; }
      
      /* Prevent horizontal scroll on mobile */
      html, body { overflow-x: hidden; }
      
      /* Touch-friendly tap targets */
      button, a, input, select, textarea { 
        min-height: 44px; 
        min-width: 44px; 
      }
      
      /* Smooth scrolling for mobile */
      html { scroll-behavior: smooth; }
      
      /* Optimize rendering */
      * { box-sizing: border-box; }
      
      /* Prevent text selection on buttons */
      button { user-select: none; }
      
      /* Optimize images */
      img { max-width: 100%; height: auto; }
      
      /* Loading spinner styles */
      .loading-spinner {
        display: inline-block;
        width: 40px;
        height: 40px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #43A047;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }
      
      .loading-container {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #f8f9fa;
      }
      
      .loading-content {
        text-align: center;
      }
      
      .loading-text {
        color: #666;
        margin: 0;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      /* Optimize font rendering */
      body {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
      }
    </style>
  </head>

  <body>
    <div id="root">
      <!-- Loading fallback -->
      <div class="loading-container">
        <div class="loading-content">
          <div class="loading-spinner"></div>
          <p class="loading-text"></p>
        </div>
      </div>
    </div>
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Chrome compatibility and performance monitoring -->
    <script>
      // Chrome-specific optimizations
      (function() {
        // Detect Chrome and apply optimizations
        const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
        
        if (isChrome) {
          console.log('üöÄ Chrome detected - applying optimizations');
          
          // Disable Chrome extensions that might interfere
          if (window.chrome && window.chrome.runtime) {
            console.log('üîå Chrome extensions detected');
          }
          
          // Optimize Chrome's memory usage
          if ('memory' in performance) {
            console.log('üíæ Chrome memory:', performance.memory);
          }
          
          // Chrome-specific localStorage optimization
          try {
            // Test localStorage capacity
            const testKey = 'chrome-perf-test';
            const testData = 'x'.repeat(1024); // 1KB test
            localStorage.setItem(testKey, testData);
            localStorage.removeItem(testKey);
            console.log('‚úÖ Chrome localStorage OK');
          } catch (e) {
            console.warn('‚ö†Ô∏è Chrome localStorage issue:', e);
          }
        }
        
        // Monitor Core Web Vitals with Chrome-specific metrics
        if ('PerformanceObserver' in window) {
          const observer = new PerformanceObserver((list) => {
            list.getEntries().forEach((entry) => {
              if (entry.entryType === 'largest-contentful-paint') {
                console.log('üéØ LCP:', entry.startTime, 'ms');
                if (entry.startTime > 2500) {
                  console.warn('‚ö†Ô∏è Slow LCP detected - consider optimization');
                }
              }
              if (entry.entryType === 'first-input') {
                const fid = entry.processingStart - entry.startTime;
                console.log('‚ö° FID:', fid, 'ms');
                if (fid > 100) {
                  console.warn('‚ö†Ô∏è Slow FID detected - consider optimization');
                }
              }
              if (entry.entryType === 'cumulative-layout-shift') {
                console.log('üìê CLS:', entry.value);
                if (entry.value > 0.1) {
                  console.warn('‚ö†Ô∏è High CLS detected - consider layout optimization');
                }
              }
            });
          });
          
          try {
            observer.observe({ entryTypes: ['largest-contentful-paint', 'first-input', 'cumulative-layout-shift'] });
          } catch (e) {
            console.warn('‚ö†Ô∏è PerformanceObserver not fully supported');
          }
        }
        
        // Enhanced loading fallback removal with Chrome optimization
        let appLoaded = false;
        const removeLoadingFallback = () => {
          if (appLoaded) return;
          appLoaded = true;
          
          const loadingFallback = document.querySelector('#root > div');
          if (loadingFallback) {
            // Add fade-out animation for Chrome
            loadingFallback.style.transition = 'opacity 0.3s ease-out';
            loadingFallback.style.opacity = '0';
            
            setTimeout(() => {
              loadingFallback.remove();
              console.log('‚úÖ Loading fallback removed');
            }, 300);
          }
        };
        
        // Multiple triggers to ensure fallback is removed
        window.addEventListener('load', removeLoadingFallback);
        window.addEventListener('DOMContentLoaded', removeLoadingFallback);
        
        // Fallback timeout for Chrome
        setTimeout(removeLoadingFallback, 5000);
        
        // Chrome-specific error handling
        window.addEventListener('error', (e) => {
          console.error('üö® Global error:', e.error);
          if (isChrome && e.error && e.error.message.includes('Chrome')) {
            console.warn('‚ö†Ô∏è Chrome-specific error detected');
          }
        });
        
        // Chrome unhandled promise rejection handling
        window.addEventListener('unhandledrejection', (e) => {
          console.error('üö® Unhandled promise rejection:', e.reason);
          if (isChrome) {
            console.warn('‚ö†Ô∏è Chrome promise rejection detected');
          }
        });
      })();
    </script>
  </body>
</html>
